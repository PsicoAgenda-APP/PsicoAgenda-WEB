"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4336],{4336:(v,m,c)=>{c.r(m),c.d(m,{CommitpayPageModule:()=>O});var h=c(177),u=c(4341),s=c(1075),g=c(9860),f=c(9107),C=c(7239),P=c.n(C),t=c(4438),_=c(3366);function b(o,r){if(1&o&&(t.j41(0,"div")(1,"table",18)(2,"caption"),t.EFF(3,"Detalle de Pago: "),t.j41(4,"strong"),t.EFF(5,"SUCCESS PAY"),t.k0s()(),t.j41(6,"thead")(7,"tr",19),t.nrm(8,"th",20)(9,"th",20)(10,"th",20),t.k0s()(),t.j41(11,"tbody")(12,"tr")(13,"td")(14,"strong"),t.EFF(15,"Estado:"),t.k0s()(),t.j41(16,"td"),t.EFF(17),t.k0s()(),t.j41(18,"tr")(19,"td")(20,"strong"),t.EFF(21,"Fecha Pago:"),t.k0s()(),t.j41(22,"td"),t.EFF(23),t.k0s()(),t.j41(24,"tr")(25,"td")(26,"strong"),t.EFF(27,"N\xb0 de tarjeta:"),t.k0s()(),t.j41(28,"td"),t.EFF(29),t.k0s()(),t.j41(30,"tr")(31,"td")(32,"strong"),t.EFF(33,"Tipo de Pago:"),t.k0s()(),t.j41(34,"td"),t.EFF(35),t.k0s()(),t.j41(36,"tr")(37,"td")(38,"strong"),t.EFF(39,"Monto Pagado:"),t.k0s()(),t.j41(40,"td"),t.EFF(41),t.k0s()(),t.j41(42,"tr")(43,"td")(44,"strong"),t.EFF(45,"Comprobante:"),t.k0s()(),t.j41(46,"td"),t.EFF(47),t.k0s()(),t.j41(48,"tr")(49,"td")(50,"strong"),t.EFF(51,"N\xb0 Orden:"),t.k0s()(),t.j41(52,"td"),t.EFF(53),t.k0s()(),t.j41(54,"tr")(55,"td")(56,"strong"),t.EFF(57,"Psicologo:"),t.k0s()(),t.j41(58,"td"),t.EFF(59),t.k0s()(),t.j41(60,"tr")(61,"td")(62,"strong"),t.EFF(63,"Fecha Cita:"),t.k0s()(),t.j41(64,"td"),t.EFF(65),t.k0s()(),t.j41(66,"tr")(67,"td")(68,"strong"),t.EFF(69,"Hora Cita:"),t.k0s()(),t.j41(70,"td"),t.EFF(71),t.k0s()()()()()),2&o){const a=t.XpG();t.R7$(17),t.JRh(a.transactionDetail.state),t.R7$(6),t.JRh(a.transactionDetail.transaction_date),t.R7$(6),t.SpI("XXXX XXXX XXXX ",a.transactionDetail.card_number,""),t.R7$(6),t.JRh(a.transactionDetail.pay_type),t.R7$(6),t.JRh(a.transactionDetail.amount),t.R7$(6),t.JRh(a.transactionDetail.authorization_code),t.R7$(6),t.JRh(a.transactionDetail.buy_order),t.R7$(6),t.JRh(a.nombrePsicologo),t.R7$(6),t.JRh(a.fechaCita),t.R7$(6),t.JRh(a.horaCita)}}function F(o,r){if(1&o){const a=t.RV6();t.j41(0,"ion-button",21),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.goHome())}),t.EFF(1,"Volver"),t.k0s()}}function E(o,r){if(1&o){const a=t.RV6();t.j41(0,"ion-button",21),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.downloadPDF())}),t.EFF(1,"Descargar Comprobante"),t.k0s()}}function y(o,r){if(1&o&&(t.j41(0,"div")(1,"h2"),t.EFF(2),t.k0s()()),2&o){const a=t.XpG();t.R7$(2),t.JRh(a.errorMessage)}}const k=[{path:"",component:(()=>{var o;class r{constructor(e,n,i){this.router=e,this.route=n,this.apiService=i,this.showOptions=!1,this.errorMessage="",this.token_ws="",this.idCita=0,this.idPaciente=0,this.login=!1,this.correo="",this.nombrePsicologo="",this.fechaCita="",this.horaCita=""}ngOnInit(){this.route.queryParams.subscribe(e=>{this.token_ws=e.token_ws,this.idCita=JSON.parse(localStorage.getItem("idCita")||"0"),this.idPaciente=JSON.parse(localStorage.getItem("idPaciente")||"0"),this.login=JSON.parse(localStorage.getItem("login")||"false"),this.correo=JSON.parse(localStorage.getItem("correo")||""),this.nombrePsicologo=JSON.parse(localStorage.getItem("nombrePsicologo")||""),this.fechaCita=JSON.parse(localStorage.getItem("fechaCita")||""),this.horaCita=JSON.parse(localStorage.getItem("horaCita")||""),console.log(this.idCita),console.log(this.idPaciente),console.log(this.correo),console.log(this.nombrePsicologo),console.log(this.fechaCita),console.log(this.horaCita),this.token_ws?this.apiService.commitTransaction(this.token_ws).subscribe(n=>{console.log("Pago Correcto"),"AUTHORIZED"===n.status&&0===n.response_code?(this.transactionDetail={card_number:n.card_detail.card_number,transaction_date:new Date(n.transaction_date).toLocaleString(),state:"AUTHORIZED"===n.status?"Aceptado":"Rechazado",pay_type:this.getPaymentType(n.payment_type_code),amount:this.formatAmount(n.amount),authorization_code:n.authorization_code,buy_order:n.buy_order},this.apiService.confirmarCita(this.idPaciente,1,this.idCita).subscribe(i=>{console.log("Cita Agendada Correctamente",i)},i=>{console.error("Error al agendar la cita",i)}),this.sendEmail()):this.errorMessage="ERROR EN LA TRANSACCI\xd3N, SE RECHAZA LA TRANSACCI\xd3N."},n=>{this.errorMessage="ERROR EN LA TRANSACCI\xd3N, SE CANCELO EL PAGO."}):this.errorMessage="ERROR EN LA TRANSACCI\xd3N, SE CANCELO EL PAGO."})}sendEmail(){this.apiService.sendEmail(this.correo,"Hora Agendada en PsicoAgenda","Hola!,\n\nAgendaste una hora a traves de PsicoAgenda APP, revisa los detalles.\n\nPsicologo: "+this.nombrePsicologo+"\n\nFecha: "+this.fechaCita+"\n\nHora: "+this.horaCita+"\n\nTe Saluda,\nEquipo de PsicoAgenda APP.",`\n              <p>Hola!,</p>\n              <p>Agendaste una hora a traves de PsicoAgenda APP, revisa los detalles.</p>\n              <p><strong>Psicologo: ${this.nombrePsicologo}</strong></p>\n              <p><strong>Fecha: ${this.fechaCita}</strong></p>\n              <p><strong>Hora: ${this.horaCita}</strong></p>\n              <p>Te Saluda,</p>\n              <p>Equipo de PsicoAgenda APP.</p>\n          `).subscribe(l=>{console.log("Email Enviado Correctamente",l)},l=>{console.error("Error al enviar correo",l)})}downloadPDF(){const e=document.getElementById("tbl-transaction-detail");e?P()(e,{scale:2}).then(i=>{const l=i.toDataURL("image/png"),d=new f.default("landscape","mm","a4"),M=d.internal.pageSize.getWidth(),p=(d.internal.pageSize.getHeight(),M-20);d.addImage(l,"PNG",10,10,p,i.height*p/i.width),d.save("Comprobante.pdf")}):console.error('El elemento con id "tbl-transaction-detail" no se encontr\xf3.')}toggleOptions(){this.showOptions=!this.showOptions}redirectTo(e){this.router.navigate([e])}goHome(){console.log("Login: ",this.login),this.login?this.router.navigate(["cliente"],{state:{login:this.login,idPaciente:this.idPaciente},replaceUrl:!0}):this.router.navigate(["home"],{replaceUrl:!0})}getPaymentType(e){return"VD"===e?"Tarjeta de D\xe9bito":"Desconocido"}formatAmount(e){return e.toLocaleString("es-CL",{style:"currency",currency:"CLP"})}}return(o=r).\u0275fac=function(e){return new(e||o)(t.rXU(g.Ix),t.rXU(g.nX),t.rXU(_.G))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-commitpay"]],decls:40,vars:4,consts:[["errorTemplate",""],[1,"toolbarheader"],["slot","start"],["slot","end"],[3,"click"],[1,"header-title"],[1,"logo-link",2,"color","#000000",3,"click"],["src","../../assets/icon/psicoagendalogo.png","alt","Logo",1,"header-logo"],[4,"ngIf","ngIfElse"],[1,"botones"],["class","boton",3,"click",4,"ngIf"],[1,"footer-content"],[1,"footer-left"],[1,"footer-center"],[1,"footer-right"],[1,"logo-link"],["name","call-outline",1,"header-logo"],["name","logo-instagram",1,"header-logo"],["id","tbl-transaction-detail"],["hidden",""],["scope","col"],[1,"boton",3,"click"]],template:function(e,n){if(1&e){const i=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2),t.nrm(3,"ion-menu-button"),t.k0s(),t.j41(4,"ion-buttons",3)(5,"ion-button",4),t.bIt("click",function(){return t.eBV(i),t.Njj(n.redirectTo("/home"))}),t.EFF(6,"Editar datos"),t.k0s(),t.j41(7,"ion-button",4),t.bIt("click",function(){return t.eBV(i),t.Njj(n.redirectTo("/atencionespaciente"))}),t.EFF(8,"Historial de atenciones"),t.k0s(),t.j41(9,"ion-button",4),t.bIt("click",function(){return t.eBV(i),t.Njj(n.redirectTo("/fichapaciente"))}),t.EFF(10,"Fichas clinicas"),t.k0s(),t.j41(11,"ion-button",4),t.bIt("click",function(){return t.eBV(i),t.Njj(n.redirectTo("/home"))}),t.EFF(12,"Cerrar sesi\xf3n"),t.k0s()(),t.j41(13,"ion-title",5)(14,"a",6),t.bIt("click",function(){return t.eBV(i),t.Njj(n.goHome())}),t.nrm(15,"img",7),t.EFF(16," PsicoAgenda "),t.k0s()()()(),t.j41(17,"ion-content"),t.DNE(18,b,72,10,"div",8),t.j41(19,"table",9),t.DNE(20,F,2,0,"ion-button",10)(21,E,2,0,"ion-button",10),t.k0s(),t.DNE(22,y,3,1,"ng-template",null,0,t.C5r),t.k0s(),t.j41(24,"ion-footer")(25,"ion-toolbar")(26,"div",11)(27,"div",12)(28,"p"),t.EFF(29,"\xa92024 - PsicoAgenda APP"),t.k0s(),t.j41(30,"p"),t.EFF(31,"Todos los Derechos Reservados"),t.k0s()(),t.nrm(32,"div",13),t.j41(33,"div",14)(34,"p",15),t.nrm(35,"ion-icon",16),t.EFF(36,"Tel\xe9fono Contacto: 920256865 "),t.k0s(),t.j41(37,"p",15),t.nrm(38,"ion-icon",17),t.EFF(39,"www.instagram.com/psicoagenda"),t.k0s()()()()()}if(2&e){const i=t.sdS(23);t.R7$(18),t.Y8G("ngIf",n.transactionDetail)("ngIfElse",i),t.R7$(2),t.Y8G("ngIf",n.transactionDetail),t.R7$(),t.Y8G("ngIf",n.transactionDetail)}},dependencies:[h.bT,s.Jm,s.QW,s.W9,s.M0,s.eU,s.iq,s.MC,s.BC,s.ai],styles:['@charset "UTF-8";ion-footer[_ngcontent-%COMP%]{--background: var(--ion-footer-background);color:var(--ion-footer-text-color);width:100%;padding:0;box-sizing:border-box;display:flex;justify-content:space-between;align-items:center;position:relative}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;--background: #333;color:#fff;padding:1.5rem;font-size:.8rem;text-align:center}ion-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{display:flexbox;justify-content:space-between;align-items:center;width:100%}ion-footer[_ngcontent-%COMP%]   .footer-left[_ngcontent-%COMP%]{flex:1;text-align:center;display:flex;flex-direction:column;justify-content:center}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]{text-align:right;position:absolute}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-text-color);text-decoration:none}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{--color: var(--ion-text-color)}ion-icon[_ngcontent-%COMP%]{font-size:2em;color:#009688;width:24px;height:24px}ion-toolbar[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--background: #32E0C4}.center-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%;flex-direction:column}.horizontal-layout[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:stretch;width:100%;gap:1px}.card-content-md[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:400;line-height:1.5}.custom-card[_ngcontent-%COMP%]{--background: url(1600w-9JEcmfgB4FU.39aaa5c7fb12f91d.png) no-repeat center center / cover;flex:.5;margin:1%;width:100%;text-align:center}.calendario[_ngcontent-%COMP%]{margin:1%}.calendario-lista[_ngcontent-%COMP%]{margin-top:0;width:100%;text-align:center}.imagen1[_ngcontent-%COMP%]{max-width:20%;margin-left:auto;margin-right:auto;margin-top:5%}ion-card-header[_ngcontent-%COMP%]{margin-top:6%}.botonpago[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;justify-content:center;align-items:center;display:flex;max-width:20%;--background: #32E0C4;margin-top:1rem;margin-bottom:1rem}table[_ngcontent-%COMP%]{margin-top:1%;width:100%;border-collapse:collapse;box-shadow:0 2px 3px #0000001a;max-width:650px;margin-left:auto;margin-right:auto}.botones[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;margin-bottom:1%}th[_ngcontent-%COMP%]{background-color:#93a2a5;color:#fff;font-weight:700;padding:12px 15px;text-align:left}td[_ngcontent-%COMP%]{background-color:#fff;color:#666;padding:10px 15px;border-top:1px solid #ddd}tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]{background-color:#cae7e0}tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background-color:#fff}']}),r})()}];let j=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[g.iI.forChild(k),g.iI]}),r})(),O=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[h.MD,u.YN,s.bv,j]}),r})()}}]);