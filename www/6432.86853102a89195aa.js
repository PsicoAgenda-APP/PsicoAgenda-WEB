"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6432],{6432:(O,T,g)=>{g.r(T),g.d(T,{CalendarioPageModule:()=>C});var v=g(177),P=g(4341),r=g(1075),m=g(9860),F=g(467),E=g(3207),t=g(4438),n=g(3366);function d(i,c){if(1&i&&(t.j41(0,"ion-card",24)(1,"ion-card-header")(2,"ion-card-title",25),t.EFF(3),t.k0s(),t.nrm(4,"ion-img",26),t.k0s(),t.j41(5,"ion-card-content")(6,"p"),t.EFF(7),t.k0s()(),t.j41(8,"ion-card-content")(9,"p"),t.EFF(10),t.k0s()()()),2&i){const l=c.$implicit;t.R7$(3),t.JRh(l.Nombre),t.R7$(4),t.JRh(l.Descripcion),t.R7$(3),t.SpI("Valor Consulta: $",l.ValorSesion,"")}}function p(i,c){1&i&&(t.j41(0,"p"),t.EFF(1,"Horas Disponibles"),t.k0s())}function u(i,c){1&i&&(t.j41(0,"p"),t.EFF(1,"No hay horas disponibles este d\xeda"),t.k0s())}function h(i,c){if(1&i){const l=t.RV6();t.j41(0,"ion-button",3),t.bIt("click",function(){const o=t.eBV(l),s=o.$implicit,a=o.index,M=t.XpG();return t.Njj(M.confirmarCita(a,s.HoraCita))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s(),t.j41(3,"p",27),t.EFF(4),t.k0s()()}if(2&i){const l=c.$implicit,e=c.index;t.R7$(2),t.JRh(l.HoraCita),t.R7$(),t.Mz_("id","id_cita_",e,""),t.R7$(),t.JRh(l.IdCita)}}function _(i,c){1&i&&(t.j41(0,"ion-button",28),t.EFF(1,"Reservar Hora"),t.k0s())}const f=[{path:"",component:(()=>{var i;class c{constructor(e,o){this.router=e,this.apiService=o,this.selectedDate="",this.fechaFinal="",this.availableTimes=[],this.showOptions=!1,this.titulo=!1,this.horas=!1,this.idPsicologoString="",this.idPsicologo=0,this.idCita="",this.lista_respuesta=[],this.validadorHora=1,this.botonPago=!1,this.monto=0,this.idPaciente=0,this.login=!1,this.correo="",this.nombrePsicologo="",this.fechaCita="",this.horaCita=""}ngOnInit(){var e=this;return(0,F.A)(function*(){const o=new Date,s=6e4*o.getTimezoneOffset();e.selectedDate=new Date(o.getTime()-s).toISOString().slice(0,-1);let a=e.router.getCurrentNavigation();null!=a&&a.extras.state&&(e.idPsicologoString=null==a?void 0:a.extras.state.idPsicologo,e.idPsicologo=parseInt(e.idPsicologoString,10),e.idPaciente=null==a?void 0:a.extras.state.idPaciente,e.login=null==a?void 0:a.extras.state.login,e.correo=null==a?void 0:a.extras.state.correo,console.log("El ID del usuario es:",e.idPsicologo));let M=e.apiService.datosPsicologo(e.idPsicologo),k=yield(0,E.s)(M),S=JSON.stringify(k),w=JSON.parse(S);for(let y=0;y<w.length;y++)e.lista_respuesta.push(w[y]),e.monto=e.lista_respuesta[y].ValorSesion,e.nombrePsicologo=e.lista_respuesta[y].Nombre,console.log(e.monto),console.log(e.lista_respuesta)})()}formatDate(e){const o=new Date(e),s=`${("0"+o.getDate()).slice(-2)}-${("0"+(o.getMonth()+1)).slice(-2)}-${o.getFullYear()}`;this.fechaFinal=s,this.fechaCita=this.fechaFinal}loadAvailableTimes(){var e=this;return(0,F.A)(function*(){if(e.horas=!1,e.availableTimes=[],e.titulo=!1,console.log("Fecha seleccionada:",e.selectedDate),e.formatDate(e.selectedDate),console.log("Id Psicologo:",e.idPsicologo),console.log("Fecha formateada:",e.fechaFinal),e.selectedDate){e.botonPago=!1;let o=e.apiService.obtenerHoras(e.idPsicologo,e.fechaFinal),s=yield(0,E.s)(o);console.log("Respuesta completa de la API:",s),Array.isArray(s)?0===s.length?(e.horas=!0,console.log("No hay horas disponibles.")):(e.titulo=!0,s.forEach(a=>{e.availableTimes.push(a),console.log("Hora disponible:",a)}),e.availableTimes.length>0&&(e.validadorHora=e.availableTimes[0].IdCita)):console.log("Respuesta no es un arreglo. Revisar el formato de los datos recibidos de la API.")}})()}scheduleAppointment(e){console.log("Cita agendada para",this.selectedDate,"a las",e)}toggleOptions(){this.showOptions=!this.showOptions}redirectTo(e){this.router.navigate([e])}goHome(){this.router.navigate(["home"],{replaceUrl:!0})}confirmarCita(e,o){this.horaCita=o;const s=document.getElementById("id_cita_"+e),M=parseInt(s?s.textContent:null,10);this.idCita=M.toString(),console.log(this.idCita),this.botonPago=!0}getRandomInt(e,o){return Math.floor(Math.random()*(o-e+1))+e}webpay_plus_create(){console.log("Webpay Plus Transaction.create");const e=this.getRandomInt(1e6,99999999).toString(),o=this.getRandomInt(1e6,99999999).toString();console.log(e),console.log(o);const s=`${window.location.origin}/commitpay`;this.apiService.createTransaction(e,o,this.monto,s).subscribe(a=>{console.log("Transaction response:",a),a.token&&a.url?(localStorage.setItem("idCita",JSON.stringify(this.idCita)),localStorage.setItem("idPaciente",JSON.stringify(this.idPaciente)),localStorage.setItem("login",JSON.stringify(this.login)),localStorage.setItem("correo",JSON.stringify(this.correo)),localStorage.setItem("nombrePsicologo",JSON.stringify(this.nombrePsicologo)),localStorage.setItem("fechaCita",JSON.stringify(this.fechaCita)),localStorage.setItem("horaCita",JSON.stringify(this.horaCita)),window.location.href=a.url+"?token_ws="+a.token):console.error("Error creating transaction")},a=>{console.error("Error creating transaction",a)})}}return(i=c).\u0275fac=function(e){return new(e||i)(t.rXU(m.Ix),t.rXU(n.G))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-calendario"]],decls:44,vars:6,consts:[[1,"toolbarheader"],["slot","start"],["slot","end"],[3,"click"],[1,"header-title"],[1,"logo-link",2,"color","#000000",3,"click"],["src","../../assets/icon/psicoagendalogo.png","alt","Logo",1,"header-logo"],[1,"center-content"],[1,"horizontal-layout"],["class","custom-card",4,"ngFor","ngForOf"],[1,"calendario"],["displayFormat","MM/DD/YYYY","presentation","date",3,"ngModelChange","ionChange","ngModel"],[1,"calendario-lista"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"submit"],["class","botonpago","type","submit",4,"ngIf"],[1,"footer-content"],[1,"footer-left"],[1,"footer-center"],[1,"footer-right"],[1,"logo-link"],["name","call-outline",1,"header-logo"],["name","logo-instagram",1,"header-logo"],[1,"custom-card"],[2,"--color","#027f99","font-weight","bold"],["src","../../../assets/icon/User_Circle.png",1,"imagen1"],["hidden","",3,"id"],["type","submit",1,"botonpago"]],template:function(e,o){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-menu-button"),t.k0s(),t.j41(4,"ion-buttons",2)(5,"ion-button",3),t.bIt("click",function(){return o.redirectTo("/home")}),t.EFF(6,"Editar datos"),t.k0s(),t.j41(7,"ion-button",3),t.bIt("click",function(){return o.redirectTo("/atencionespaciente")}),t.EFF(8,"Historial de atenciones"),t.k0s(),t.j41(9,"ion-button",3),t.bIt("click",function(){return o.redirectTo("/fichapaciente")}),t.EFF(10,"Fichas clinicas"),t.k0s(),t.j41(11,"ion-button",3),t.bIt("click",function(){return o.redirectTo("/home")}),t.EFF(12,"Cerrar sesi\xf3n"),t.k0s()(),t.j41(13,"ion-title",4)(14,"a",5),t.bIt("click",function(){return o.goHome()}),t.nrm(15,"img",6),t.EFF(16," PsicoAgenda "),t.k0s()()()(),t.j41(17,"ion-content",7)(18,"div",8),t.DNE(19,d,11,3,"ion-card",9),t.j41(20,"ion-item",10)(21,"ion-datetime",11),t.mxI("ngModelChange",function(a){return t.DH7(o.selectedDate,a)||(o.selectedDate=a),a}),t.bIt("ionChange",function(){return o.loadAvailableTimes()}),t.k0s()()(),t.j41(22,"ion-list",12),t.DNE(23,p,2,0,"p",13)(24,u,2,0,"p",13)(25,h,5,4,"ion-button",14),t.j41(26,"form",15),t.bIt("submit",function(){return o.webpay_plus_create()}),t.DNE(27,_,2,0,"ion-button",16),t.k0s()()(),t.j41(28,"ion-footer")(29,"ion-toolbar")(30,"div",17)(31,"div",18)(32,"p"),t.EFF(33,"\xa92024 - PsicoAgenda APP"),t.k0s(),t.j41(34,"p"),t.EFF(35,"Todos los Derechos Reservados"),t.k0s()(),t.nrm(36,"div",19),t.j41(37,"div",20)(38,"p",21),t.nrm(39,"ion-icon",22),t.EFF(40,"Tel\xe9fono Contacto: 920256865 "),t.k0s(),t.j41(41,"p",21),t.nrm(42,"ion-icon",23),t.EFF(43,"www.instagram.com/psicoagenda"),t.k0s()()()()()),2&e&&(t.R7$(19),t.Y8G("ngForOf",o.lista_respuesta),t.R7$(2),t.R50("ngModel",o.selectedDate),t.R7$(2),t.Y8G("ngIf",o.titulo),t.R7$(),t.Y8G("ngIf",o.horas),t.R7$(),t.Y8G("ngForOf",o.availableTimes),t.R7$(2),t.Y8G("ngIf",o.botonPago))},dependencies:[v.Sq,v.bT,P.qT,P.BC,P.cb,P.vS,P.cV,r.Jm,r.QW,r.b_,r.I9,r.ME,r.tN,r.W9,r.A9,r.M0,r.eU,r.iq,r.KW,r.uz,r.he,r.nf,r.MC,r.BC,r.ai,r.Je],styles:['@charset "UTF-8";ion-footer[_ngcontent-%COMP%]{--background: var(--ion-footer-background);color:var(--ion-footer-text-color);width:100%;padding:0;box-sizing:border-box;display:flex;justify-content:space-between;align-items:center;position:relative}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;--background: #333;color:#fff;padding:1.5rem;font-size:.8rem;text-align:center}ion-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{display:flexbox;justify-content:space-between;align-items:center;width:100%}ion-footer[_ngcontent-%COMP%]   .footer-left[_ngcontent-%COMP%]{flex:1;text-align:center;display:flex;flex-direction:column;justify-content:center}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]{text-align:right;position:absolute}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-text-color);text-decoration:none}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{--color: var(--ion-text-color)}ion-icon[_ngcontent-%COMP%]{font-size:2em;color:#009688;width:24px;height:24px}ion-toolbar[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--background: #32E0C4}.center-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%;flex-direction:column}.horizontal-layout[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:stretch;width:100%;gap:1px}.card-content-md[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:400;line-height:1.5}.custom-card[_ngcontent-%COMP%]{--background: url(1600w-9JEcmfgB4FU.39aaa5c7fb12f91d.png) no-repeat center center / cover;flex:.5;margin:1%;width:100%;text-align:center}.calendario[_ngcontent-%COMP%]{margin:1%}.calendario-lista[_ngcontent-%COMP%]{margin-top:0;width:100%;text-align:center}.imagen1[_ngcontent-%COMP%]{max-width:20%;margin-left:auto;margin-right:auto;margin-top:5%}ion-card-header[_ngcontent-%COMP%]{margin-top:6%}.botonpago[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;justify-content:center;align-items:center;display:flex;max-width:20%;--background: #32E0C4;margin-top:1rem;margin-bottom:1rem}']}),c})()}];let b=(()=>{var i;class c{}return(i=c).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[m.iI.forChild(f),m.iI]}),c})(),C=(()=>{var i;class c{}return(i=c).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[v.MD,P.YN,r.bv,b]}),c})()},3366:(O,T,g)=>{g.d(T,{G:()=>r});var v=g(4438),P=g(1626);let r=(()=>{var m;class F{constructor(t){this.http=t,this.ruta="https://psicoagenda-api.azurewebsites.net/usuarios/login/",this.ruta_ps="https://psicoagenda-api.azurewebsites.net/psicologos/get_psicologos/",this.ruta_busqueda_ps="https://psicoagenda-api.azurewebsites.net/psicologos/datos_psicologo/",this.ruta_prestadores="https://prestadores.azurewebsites.net/profesionales/get_profesionales/",this.ruta_horas="https://psicoagenda-api.azurewebsites.net/psicologos/horas_psicologo/",this.ruta_detalles_citas="https://psicoagenda-api.azurewebsites.net/usuarios/get_citas_by_id",this.ruta_proxima_cita="https://psicoagenda-api.azurewebsites.net/usuarios/get_proxima_cita_by_id",this.ruta_citas_psicologo="https://psicoagenda-api.azurewebsites.net/psicologos/get_citas_psicologo",this.ruta_atenciones_psicologo="https://psicoagenda-api.azurewebsites.net/psicologos/get_atenciones_psicologo",this.ruta_historial_psicologo="https://psicoagenda-api.azurewebsites.net/psicologos/get_historial_psicologo",this.rutaId="https://psicoagenda-api.azurewebsites.net/usuarios/obtener_id/",this.rutaCita="https://psicoagenda-api.azurewebsites.net/paciente/agendarCita/",this.rutaRegistroPsicologo="https://psicoagenda-api.azurewebsites.net/usuarios/registro_psicologo/",this.rutaRecuperacion="https://psicoagenda-api.azurewebsites.net/usuarios/cambiar_contrasena/",this.rutaToken="https://psicoagenda-api.azurewebsites.net/usuarios/guadarToken/",this.rutaInsertarPaciente="https://psicoagenda-api.azurewebsites.net/usuarios/insertar_paciente/",this.rutaMantenedorCita="https://psicoagenda-api.azurewebsites.net/admin/buscarCita/",this.rutaBuscarUsuario="https://psicoagenda-api.azurewebsites.net/admin/buscarUsuario/",this.rutaBuscarComuna="https://psicoagenda-api.azurewebsites.net/usuarios/comuna/",this.rutaBuscarEspecialidad="https://psicoagenda-api.azurewebsites.net/psicologos/especialidad/",this.rutaEspecialidades="https://psicoagenda-api.azurewebsites.net/psicologos/allEspecialidades/"}sendEmail(t,n,d,p){return this.http.post("https://psicoagenda-api.azurewebsites.net/api/v1/email/send",{to:t,subject:n,text:d,html:p})}adminCita(t,n){return this.http.get(this.rutaMantenedorCita+"?Criterio="+t+"&Dato="+n).pipe()}buscarUsuario(t,n){return this.http.get(this.rutaBuscarUsuario+"?Criterio="+t+"&Dato="+n).pipe()}buscarComuna(t){return this.http.get(this.rutaBuscarComuna+"?NombreComuna="+t).pipe()}buscarEspecilidad(t){return this.http.get(this.rutaBuscarEspecialidad+"?NombreEspecialidad="+t).pipe()}especilidades(){return this.http.get(this.rutaEspecialidades)}updatePaciente(t,n,d,p,u,h,_,I,f,b){return this.http.post("https://psicoagenda-api.azurewebsites.net/usuarios/patch_paciente/",{IdPersona:t,IdDireccion:n,Calle:d,Numero:p,IdComuna:u,Telefono:h,PrimerNombre:_,SegundoNombre:I,ApellidoPaterno:f,ApellidoMaterno:b})}updatePsicologo(t,n,d,p,u,h,_,I,f,b,C,i,c,l){return this.http.post("https://psicoagenda-api.azurewebsites.net/psicologos/patch_psicologo/",{IdUsuario:t,IdPersona:n,IdDireccion:d,Calle:p,Numero:u,IdComuna:h,ValorSesion:_,Telefono:I,Descripcion:f,IdEspecialidad:b,PrimerNombre:C,SegundoNombre:i,ApellidoPaterno:c,ApellidoMaterno:l})}recuperacionClave(t,n){return this.http.get(this.rutaRecuperacion+"?CorreoElectronico="+t+"&NuevaContrasena="+n).pipe()}obtenerUsuario(t,n){return this.http.get(this.ruta+"?CorreoElectronico="+t+"&Contrasena="+n).pipe()}obtenerHoras(t,n){return this.http.get(this.ruta_horas+"?IdPsicologo="+t+"&FechaCita="+n).pipe()}listaPsicologos(){return this.http.get(this.ruta_ps).pipe()}datosPsicologo(t){return this.http.get(this.ruta_busqueda_ps+"?IdPsicologo="+t).pipe()}validarPrestadores(t){return this.http.get(this.ruta_prestadores+"?Rut="+t).pipe()}obtenerDetallesCitas(t){return this.http.get(this.ruta_detalles_citas+"?IdPaciente="+t).pipe()}obtenerProximaCita(t){return this.http.get(this.ruta_proxima_cita+"?IdPaciente="+t).pipe()}obtenerCitaPsicologo(t){return this.http.get(this.ruta_citas_psicologo+"?IdPsicologo="+t).pipe()}obtenerHistorialPsicologo(t){return this.http.get(this.ruta_historial_psicologo+"?IdPsicologo="+t).pipe()}obtenerAtencionesPsicologo(t){return this.http.get(this.ruta_atenciones_psicologo+"?IdPsicologo="+t).pipe()}createTransaction(t,n,d,p){return this.http.post("https://psicoagenda-api.azurewebsites.net/api/v1/transbank/transaction/create",{buy_order:t,session_id:n,amount:d,return_url:p})}commitTransaction(t){return this.http.put(`https://psicoagenda-api.azurewebsites.net/api/v1/transbank/transaction/commit/${t}`,{token:t})}getId(t,n){return this.http.get(this.rutaId+"?IdTipoUsuario="+t+"&IdUsuario="+n).pipe()}confirmarCita(t,n,d){return this.http.get(this.rutaCita+"?IdPaciente="+t+"&IdEstadoCita="+n+"&IdCita="+d).pipe()}registrarPsicologo(t,n,d,p,u,h,_,I,f,b,C,i,c,l,e){return this.http.post(this.rutaRegistroPsicologo,{Calle:t,Numero:n,IdComuna:d,PrimerNombre:p,SegundoNombre:u,ApellidoPaterno:h,ApellidoMaterno:_,Telefono:I,FechaNacimiento:f,CorreoElectronico:b,Contrasena:C,IdTipoUsuario:i,Rut:c,ValorSesion:l,IdEspecialidad:e})}guardarToken(t,n){return this.http.get(this.rutaToken+"?Token="+t+"&CorreoElectronico="+n).pipe()}registrarPaciente(t,n,d,p,u,h,_,I,f,b,C,i,c){return this.http.post(this.rutaInsertarPaciente,{Calle:t,Numero:n,IdComuna:d,PrimerNombre:p,SegundoNombre:u,ApellidoPaterno:h,ApellidoMaterno:_,Telefono:I,FechaNacimiento:f,CorreoElectronico:b,Contrasena:C,IdTipoUsuario:i,Rut:c})}}return(m=F).\u0275fac=function(t){return new(t||m)(v.KVO(P.Qq))},m.\u0275prov=v.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),F})()}}]);