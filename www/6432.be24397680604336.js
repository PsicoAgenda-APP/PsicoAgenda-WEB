"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6432],{6432:(k,O,u)=>{u.r(O),u.d(O,{CalendarioPageModule:()=>P});var F=u(177),I=u(4341),r=u(1075),m=u(9860),w=u(467),E=u(3207),t=u(4438),a=u(3366);function c(i,s){if(1&i&&(t.j41(0,"ion-card",24)(1,"ion-card-header")(2,"ion-card-title",25),t.EFF(3),t.k0s(),t.nrm(4,"ion-img",26),t.k0s(),t.j41(5,"ion-card-content")(6,"p"),t.EFF(7),t.k0s()(),t.j41(8,"ion-card-content")(9,"p"),t.EFF(10),t.k0s()()()),2&i){const d=s.$implicit;t.R7$(3),t.JRh(d.Nombre),t.R7$(4),t.JRh(d.Descripcion),t.R7$(3),t.SpI("Valor Consulta: $",d.ValorSesion,"")}}function g(i,s){1&i&&(t.j41(0,"p"),t.EFF(1,"Horas Disponibles"),t.k0s())}function p(i,s){1&i&&(t.j41(0,"p"),t.EFF(1,"No hay horas disponibles este d\xeda"),t.k0s())}function h(i,s){1&i&&(t.j41(0,"p"),t.EFF(1,"Lo sentimos, pero no puedes seleccionar una fecha anterior a hoy. Por favor, elige una fecha futura."),t.k0s())}function f(i,s){if(1&i){const d=t.RV6();t.j41(0,"ion-button",3),t.bIt("click",function(){const o=t.eBV(d),n=o.$implicit,l=o.index,v=t.XpG();return t.Njj(v.confirmarCita(l,n.HoraCita))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s(),t.j41(3,"p",27),t.EFF(4),t.k0s()()}if(2&i){const d=s.$implicit,e=s.index;t.R7$(2),t.JRh(d.HoraCita),t.R7$(),t.Mz_("id","id_cita_",e,""),t.R7$(),t.JRh(d.IdCita)}}function _(i,s){1&i&&(t.j41(0,"ion-button",28),t.EFF(1,"Reservar Hora"),t.k0s())}const b=[{path:"",component:(()=>{var i;class s{constructor(e,o){this.router=e,this.apiService=o,this.selectedDate="",this.fechaFinal="",this.availableTimes=[],this.showOptions=!1,this.titulo=!1,this.horas=!1,this.fechaAnterior=!1,this.idPsicologoString="",this.idPsicologo=0,this.idCita="",this.lista_respuesta=[],this.validadorHora=1,this.botonPago=!1,this.monto=0,this.idPaciente=0,this.login=!1,this.correo="",this.nombrePsicologo="",this.fechaCita="",this.horaCita="",this.idTipo=0,this.idUsuario=0,this.idPersona=0}ngOnInit(){var e=this;return(0,w.A)(function*(){let o=e.router.getCurrentNavigation();if(null!=o&&o.extras.state&&(e.idPsicologoString=null==o?void 0:o.extras.state.idPsicologo,e.idPsicologo=parseInt(e.idPsicologoString,10),e.idPaciente=null==o?void 0:o.extras.state.idPaciente,e.login=null==o?void 0:o.extras.state.login,e.correo=null==o?void 0:o.extras.state.correo,e.idPersona=null==o?void 0:o.extras.state.idPersona,e.idUsuario=null==o?void 0:o.extras.state.idUsuario,console.log("El ID del usuario es:",e.idUsuario)),e.login){const n=new Date,l=6e4*n.getTimezoneOffset();e.selectedDate=new Date(n.getTime()-l).toISOString().slice(0,-1);let v=e.apiService.datosPsicologo(e.idPsicologo),M=yield(0,E.s)(v),D=JSON.stringify(M),S=JSON.parse(D);for(let T=0;T<S.length;T++)e.lista_respuesta.push(S[T]),e.monto=e.lista_respuesta[T].ValorSesion,e.nombrePsicologo=e.lista_respuesta[T].Nombre,console.log(e.monto),console.log(e.lista_respuesta)}else e.router.navigate(["home"])})()}formatDate(e){const o=new Date(e),n=`${("0"+o.getDate()).slice(-2)}-${("0"+(o.getMonth()+1)).slice(-2)}-${o.getFullYear()}`;this.fechaFinal=n,this.fechaCita=this.fechaFinal}getCurrentDate(){const e=new Date;return`${String(e.getDate()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${e.getFullYear()}`}loadAvailableTimes(){var e=this;return(0,w.A)(function*(){e.horas=!1,e.fechaAnterior=!1,e.availableTimes=[],e.titulo=!1,console.log("Fecha seleccionada:",e.selectedDate),e.formatDate(e.selectedDate),console.log("Id Psicologo:",e.idPsicologo),console.log("Fecha formateada:",e.fechaFinal);const o=e.getCurrentDate();console.log("Hoy: "+o);const n=e.parseDate(o);if(e.parseDate(e.fechaFinal)<n)e.fechaAnterior=!0;else if(e.selectedDate){e.botonPago=!1;let v=e.apiService.obtenerHoras(e.idPsicologo,e.fechaFinal),M=yield(0,E.s)(v);console.log("Respuesta completa de la API:",M),Array.isArray(M)?0===M.length?(e.horas=!0,console.log("No hay horas disponibles.")):(e.titulo=!0,M.forEach(D=>{e.availableTimes.push(D),console.log("Hora disponible:",D)}),e.availableTimes.length>0&&(e.validadorHora=e.availableTimes[0].IdCita)):console.log("Respuesta no es un arreglo. Revisar el formato de los datos recibidos de la API.")}})()}parseDate(e){const[o,n,l]=e.split("-").map(v=>parseInt(v,10));return new Date(l,n-1,o)}scheduleAppointment(e){console.log("Cita agendada para",this.selectedDate,"a las",e)}toggleOptions(){this.showOptions=!this.showOptions}redirectTo(e){this.router.navigate([e])}goHome(){this.login?this.router.navigate(["cliente"],{state:{login:this.login,idPaciente:this.idPaciente,correo:this.correo,idUsuario:this.idUsuario,idTipo:this.idTipo,idPersona:this.idPersona},replaceUrl:!0}):this.router.navigate(["home"],{replaceUrl:!0})}goEditar(){this.router.navigate(["editarpaciente"],{state:{login:this.login,idPaciente:this.idPaciente,correo:this.correo,idUsuario:this.idUsuario,idTipo:this.idTipo,idPersona:this.idPersona},replaceUrl:!0})}confirmarCita(e,o){this.horaCita=o;const n=document.getElementById("id_cita_"+e),v=parseInt(n?n.textContent:null,10);this.idCita=v.toString(),console.log(this.idCita),this.botonPago=!0}getRandomInt(e,o){return Math.floor(Math.random()*(o-e+1))+e}webpay_plus_create(){console.log("Webpay Plus Transaction.create");const e=this.getRandomInt(1e6,99999999).toString(),o=this.getRandomInt(1e6,99999999).toString();console.log(e),console.log(o);const n=`${window.location.origin}/commitpay`;this.apiService.createTransaction(e,o,this.monto,n).subscribe(l=>{console.log("Transaction response:",l),l.token&&l.url?(localStorage.setItem("idCita",JSON.stringify(this.idCita)),localStorage.setItem("idPaciente",JSON.stringify(this.idPaciente)),localStorage.setItem("login",JSON.stringify(this.login)),localStorage.setItem("correo",JSON.stringify(this.correo)),localStorage.setItem("nombrePsicologo",JSON.stringify(this.nombrePsicologo)),localStorage.setItem("fechaCita",JSON.stringify(this.fechaCita)),localStorage.setItem("horaCita",JSON.stringify(this.horaCita)),localStorage.setItem("idPersona",JSON.stringify(this.idPersona)),localStorage.setItem("idUsuario",JSON.stringify(this.idUsuario)),window.location.href=l.url+"?token_ws="+l.token):console.error("Error creating transaction")},l=>{console.error("Error creating transaction",l)})}goHistorial(){console.log("Login: ",this.login),this.router.navigate(["atencionespaciente"],{state:{login:this.login,idPaciente:this.idPaciente,correo:this.correo,idUsuario:this.idUsuario,idTipo:this.idTipo,idPersona:this.idPersona},replaceUrl:!0})}logout(){this.login=!1,this.router.navigate(["home"],{state:{login:this.login},replaceUrl:!0})}}return(i=s).\u0275fac=function(e){return new(e||i)(t.rXU(m.Ix),t.rXU(a.G))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-calendario"]],decls:43,vars:7,consts:[[1,"toolbarheader"],["slot","start"],["slot","end"],[3,"click"],[1,"header-title"],[1,"logo-link",2,"color","#000000",3,"click"],["src","../../assets/icon/psicoagendalogo.png","alt","Logo",1,"header-logo"],[1,"center-content"],[1,"horizontal-layout"],["class","custom-card",4,"ngFor","ngForOf"],[1,"calendario"],["displayFormat","MM/DD/YYYY","presentation","date",3,"ngModelChange","ionChange","ngModel"],[1,"calendario-lista"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"submit"],["class","botonpago","type","submit",4,"ngIf"],[1,"footer-content"],[1,"footer-left"],[1,"footer-center"],[1,"footer-right"],[1,"logo-link"],["name","call-outline",1,"header-logo"],["name","logo-instagram",1,"header-logo"],[1,"custom-card"],[2,"--color","#027f99","font-weight","bold"],["src","../../../assets/icon/User_Circle.png",1,"imagen1"],["hidden","",3,"id"],["type","submit",1,"botonpago"]],template:function(e,o){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-menu-button"),t.k0s(),t.j41(4,"ion-buttons",2)(5,"ion-button",3),t.bIt("click",function(){return o.goEditar()}),t.EFF(6,"Editar datos"),t.k0s(),t.j41(7,"ion-button",3),t.bIt("click",function(){return o.goHistorial()}),t.EFF(8,"Historial de atenciones"),t.k0s(),t.j41(9,"ion-button",3),t.bIt("click",function(){return o.logout()}),t.EFF(10,"Cerrar sesi\xf3n"),t.k0s()(),t.j41(11,"ion-title",4)(12,"a",5),t.bIt("click",function(){return o.goHome()}),t.nrm(13,"img",6),t.EFF(14," PsicoAgenda "),t.k0s()()()(),t.j41(15,"ion-content",7)(16,"div",8),t.DNE(17,c,11,3,"ion-card",9),t.j41(18,"ion-item",10)(19,"ion-datetime",11),t.mxI("ngModelChange",function(l){return t.DH7(o.selectedDate,l)||(o.selectedDate=l),l}),t.bIt("ionChange",function(){return o.loadAvailableTimes()}),t.k0s()()(),t.j41(20,"ion-list",12),t.DNE(21,g,2,0,"p",13)(22,p,2,0,"p",13)(23,h,2,0,"p",13)(24,f,5,4,"ion-button",14),t.j41(25,"form",15),t.bIt("submit",function(){return o.webpay_plus_create()}),t.DNE(26,_,2,0,"ion-button",16),t.k0s()()(),t.j41(27,"ion-footer")(28,"ion-toolbar")(29,"div",17)(30,"div",18)(31,"p"),t.EFF(32,"\xa92024 - PsicoAgenda APP"),t.k0s(),t.j41(33,"p"),t.EFF(34,"Todos los Derechos Reservados"),t.k0s()(),t.nrm(35,"div",19),t.j41(36,"div",20)(37,"p",21),t.nrm(38,"ion-icon",22),t.EFF(39,"Tel\xe9fono Contacto: 920256865 "),t.k0s(),t.j41(40,"p",21),t.nrm(41,"ion-icon",23),t.EFF(42,"www.instagram.com/psicoagenda"),t.k0s()()()()()),2&e&&(t.R7$(17),t.Y8G("ngForOf",o.lista_respuesta),t.R7$(2),t.R50("ngModel",o.selectedDate),t.R7$(2),t.Y8G("ngIf",o.titulo),t.R7$(),t.Y8G("ngIf",o.horas),t.R7$(),t.Y8G("ngIf",o.fechaAnterior),t.R7$(),t.Y8G("ngForOf",o.availableTimes),t.R7$(2),t.Y8G("ngIf",o.botonPago))},dependencies:[F.Sq,F.bT,I.qT,I.BC,I.cb,I.vS,I.cV,r.Jm,r.QW,r.b_,r.I9,r.ME,r.tN,r.W9,r.A9,r.M0,r.eU,r.iq,r.KW,r.uz,r.he,r.nf,r.MC,r.BC,r.ai,r.Je],styles:['@charset "UTF-8";ion-footer[_ngcontent-%COMP%]{--background: var(--ion-footer-background);color:var(--ion-footer-text-color);width:100%;padding:0;box-sizing:border-box;display:flex;justify-content:space-between;align-items:center;position:relative}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;--background: #333;color:#fff;padding:1.5rem;font-size:.8rem;text-align:center}ion-footer[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{display:flexbox;justify-content:space-between;align-items:center;width:100%}ion-footer[_ngcontent-%COMP%]   .footer-left[_ngcontent-%COMP%]{flex:1;text-align:center;display:flex;flex-direction:column;justify-content:center}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]{text-align:right;position:absolute}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-text-color);text-decoration:none}ion-footer[_ngcontent-%COMP%]   .footer-right[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{--color: var(--ion-text-color)}ion-icon[_ngcontent-%COMP%]{font-size:2em;color:#009688;width:24px;height:24px}ion-toolbar[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--background: #32E0C4}.center-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%;flex-direction:column}.horizontal-layout[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:stretch;width:100%;gap:1px}.card-content-md[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:400;line-height:1.5}.custom-card[_ngcontent-%COMP%]{--background: url(1600w-9JEcmfgB4FU.39aaa5c7fb12f91d.png) no-repeat center center / cover;flex:.5;margin:1%;width:100%;text-align:center}.calendario[_ngcontent-%COMP%]{margin:1%}.calendario-lista[_ngcontent-%COMP%]{margin-top:0;width:100%;text-align:center}.imagen1[_ngcontent-%COMP%]{max-width:20%;margin-left:auto;margin-right:auto;margin-top:5%}ion-card-header[_ngcontent-%COMP%]{margin-top:6%}.botonpago[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;justify-content:center;align-items:center;display:flex;max-width:20%;--background: #32E0C4;margin-top:1rem;margin-bottom:1rem}']}),s})()}];let C=(()=>{var i;class s{}return(i=s).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[m.iI.forChild(b),m.iI]}),s})(),P=(()=>{var i;class s{}return(i=s).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[F.MD,I.YN,r.bv,C]}),s})()},3366:(k,O,u)=>{u.d(O,{G:()=>r});var F=u(4438),I=u(1626);let r=(()=>{var m;class w{constructor(t){this.http=t,this.ruta="https://psicoagenda-api.azurewebsites.net/usuarios/login/",this.ruta_ps="https://psicoagenda-api.azurewebsites.net/psicologos/get_psicologos/",this.ruta_busqueda_ps="https://psicoagenda-api.azurewebsites.net/psicologos/datos_psicologo/",this.ruta_prestadores="https://prestadores.azurewebsites.net/profesionales/get_profesionales/",this.ruta_horas="https://psicoagenda-api.azurewebsites.net/psicologos/horas_psicologo/",this.ruta_detalles_citas="https://psicoagenda-api.azurewebsites.net/usuarios/get_citas_by_id",this.ruta_proxima_cita="https://psicoagenda-api.azurewebsites.net/usuarios/get_proxima_cita_by_id",this.ruta_citas_psicologo="https://psicoagenda-api.azurewebsites.net/psicologos/get_citas_psicologo",this.ruta_atenciones_psicologo="https://psicoagenda-api.azurewebsites.net/psicologos/get_atenciones_psicologo",this.ruta_historial_psicologo="https://psicoagenda-api.azurewebsites.net/psicologos/get_historial_psicologo",this.rutaId="https://psicoagenda-api.azurewebsites.net/usuarios/obtener_id/",this.rutaCita="https://psicoagenda-api.azurewebsites.net/paciente/agendarCita/",this.rutaRegistroPsicologo="https://psicoagenda-api.azurewebsites.net/usuarios/registro_psicologo/",this.rutaRecuperacion="https://psicoagenda-api.azurewebsites.net/usuarios/cambiar_contrasena/",this.rutaToken="https://psicoagenda-api.azurewebsites.net/usuarios/guadarToken/",this.rutaInsertarPaciente="https://psicoagenda-api.azurewebsites.net/usuarios/insertar_paciente/",this.rutaMantenedorCita="https://psicoagenda-api.azurewebsites.net/admin/buscarCita/",this.rutaBuscarUsuario="https://psicoagenda-api.azurewebsites.net/admin/buscarUsuario/",this.rutaBuscarComuna="https://psicoagenda-api.azurewebsites.net/usuarios/comuna/",this.rutaBuscarEspecialidad="https://psicoagenda-api.azurewebsites.net/psicologos/especialidad/",this.rutaEspecialidades="https://psicoagenda-api.azurewebsites.net/psicologos/allEspecialidades/",this.rutaBuscarPsicologos="https://psicoagenda-api.azurewebsites.net/psicologos/buscar_psicologos/",this.rutaComunas="https://psicoagenda-api.azurewebsites.net/usuarios/todasLasComunas/",this.rutaAsignadas="https://psicoagenda-api.azurewebsites.net/usuarios/citas_asignadas/",this.rutaPersona="https://psicoagenda-api.azurewebsites.net/usuarios/datosPaciente/",this.rutaFinalizarCita="https://psicoagenda-api.azurewebsites.net/paciente/finalizarCita/"}sendEmail(t,a,c,g){return this.http.post("https://psicoagenda-api.azurewebsites.net/api/v1/email/send",{to:t,subject:a,text:c,html:g})}adminCita(t,a){return this.http.get(this.rutaMantenedorCita+"?Criterio="+t+"&Dato="+a).pipe()}buscarPsicologos(t,a,c){return this.http.get(this.rutaBuscarPsicologos+"?Criterio="+t+"&Dato="+a+"&Dato2="+c).pipe()}buscarUsuario(t,a){return this.http.get(this.rutaBuscarUsuario+"?Criterio="+t+"&Dato="+a).pipe()}buscarComuna(t){return this.http.get(this.rutaBuscarComuna+"?NombreComuna="+t).pipe()}buscarEspecilidad(t){return this.http.get(this.rutaBuscarEspecialidad+"?NombreEspecialidad="+t).pipe()}citasAsignadas(t){return this.http.get(this.rutaAsignadas+"?IdPaciente="+t).pipe()}especilidades(){return this.http.get(this.rutaEspecialidades)}obtenerComunas(){return this.http.get(this.rutaComunas)}updatePaciente(t,a,c,g,p,h,f,_,y,b){return this.http.post("https://psicoagenda-api.azurewebsites.net/usuarios/patch_paciente/",{IdPersona:t,IdDireccion:a,Calle:c,Numero:g,IdComuna:p,Telefono:h,PrimerNombre:f,SegundoNombre:_,ApellidoPaterno:y,ApellidoMaterno:b})}updatePsicologo(t,a,c,g,p,h,f,_,y,b,C,P,i,s){return this.http.post("https://psicoagenda-api.azurewebsites.net/psicologos/patch_psicologo/",{IdUsuario:t,IdPersona:a,IdDireccion:c,Calle:g,Numero:p,IdComuna:h,ValorSesion:f,Telefono:_,Descripcion:y,IdEspecialidad:b,PrimerNombre:C,SegundoNombre:P,ApellidoPaterno:i,ApellidoMaterno:s})}recuperacionClave(t,a){return this.http.get(this.rutaRecuperacion+"?CorreoElectronico="+t+"&NuevaContrasena="+a).pipe()}obtenerUsuario(t,a){return this.http.get(this.ruta+"?CorreoElectronico="+t+"&Contrasena="+a).pipe()}obtenerHoras(t,a){return this.http.get(this.ruta_horas+"?IdPsicologo="+t+"&FechaCita="+a).pipe()}listaPsicologos(){return this.http.get(this.ruta_ps).pipe()}datosPsicologo(t){return this.http.get(this.ruta_busqueda_ps+"?IdPsicologo="+t).pipe()}validarPrestadores(t){return this.http.get(this.ruta_prestadores+"?Rut="+t).pipe()}obtenerDetallesCitas(t){return this.http.get(this.ruta_detalles_citas+"?IdPaciente="+t).pipe()}datosPersona(t){return this.http.get(this.rutaPersona+"?IdPersona="+t).pipe()}obtenerProximaCita(t){return this.http.get(this.ruta_proxima_cita+"?IdPaciente="+t).pipe()}obtenerCitaPsicologo(t){return this.http.get(this.ruta_citas_psicologo+"?IdPsicologo="+t).pipe()}obtenerHistorialPsicologo(t){return this.http.get(this.ruta_historial_psicologo+"?IdPsicologo="+t).pipe()}obtenerAtencionesPsicologo(t){return this.http.get(this.ruta_atenciones_psicologo+"?IdPsicologo="+t).pipe()}createTransaction(t,a,c,g){return this.http.post("https://psicoagenda-api.azurewebsites.net/api/v1/transbank/transaction/create",{buy_order:t,session_id:a,amount:c,return_url:g})}commitTransaction(t){return this.http.put(`https://psicoagenda-api.azurewebsites.net/api/v1/transbank/transaction/commit/${t}`,{token:t})}getId(t,a){return this.http.get(this.rutaId+"?IdTipoUsuario="+t+"&IdUsuario="+a).pipe()}confirmarCita(t,a,c){return this.http.get(this.rutaCita+"?IdPaciente="+t+"&IdEstadoCita="+a+"&IdCita="+c).pipe()}finalizarCita(t,a,c){return this.http.get(this.rutaFinalizarCita+"?Tratamiento="+t+"&Diagnostico="+a+"&IdCita="+c).pipe()}registrarPsicologo(t,a,c,g,p,h,f,_,y,b,C,P,i,s,d){return this.http.post(this.rutaRegistroPsicologo,{Calle:t,Numero:a,IdComuna:c,PrimerNombre:g,SegundoNombre:p,ApellidoPaterno:h,ApellidoMaterno:f,Telefono:_,FechaNacimiento:y,CorreoElectronico:b,Contrasena:C,IdTipoUsuario:P,Rut:i,ValorSesion:s,IdEspecialidad:d})}guardarToken(t,a){return this.http.get(this.rutaToken+"?Token="+t+"&CorreoElectronico="+a).pipe()}registrarPaciente(t,a,c,g,p,h,f,_,y,b,C,P,i){return this.http.post(this.rutaInsertarPaciente,{Calle:t,Numero:a,IdComuna:c,PrimerNombre:g,SegundoNombre:p,ApellidoPaterno:h,ApellidoMaterno:f,Telefono:_,FechaNacimiento:y,CorreoElectronico:b,Contrasena:C,IdTipoUsuario:P,Rut:i})}}return(m=w).\u0275fac=function(t){return new(t||m)(F.KVO(I.Qq))},m.\u0275prov=F.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),w})()}}]);